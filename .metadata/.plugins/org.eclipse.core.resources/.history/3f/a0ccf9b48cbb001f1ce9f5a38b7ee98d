package co.kh.dev.home.controller.user;
import java.io.IOException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import co.kh.dev.common.MyUtility;
import co.kh.dev.home.model.CustomerDAO;
import co.kh.dev.home.model.CustomerVO;

@WebServlet({ "/customerUpdateServlet.do" })
public class CustomerUpdateServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;
    public CustomerUpdateServlet() {
        super();
    }
    private void processRequest(HttpServletRequest request, HttpServletResponse response) {
    	HttpSession session = request.getSession(false);
    	CustomerVO cvo = MyUtility.returnCvoBySession(session);
    	CustomerDAO cDAO = CustomerDAO.getInstance();
    	String status=null;
    	CustomerVO cvo2 = new CustomerVO();
    	cvo2.setPwd((String)request.getParameter("pwd"));
    	cvo2.setName((String)request.getParameter("name"));
    	cvo2.setNickName((String)request.getParameter("nickName"));
    	cvo2.setEmail((String)request.getParameter("email"));
    	cvo2.setTel((String)request.getParameter("tel"));
    	cvo2.setPhone((String)request.getParameter("phone"));
    	cvo2.setBirth((String)request.getParameter("birth"));
    	cvo2.setZipCode((String)request.getParameter("zipcode"));
    	cvo2.setAddress1((String)request.getParameter("address1"));
    	cvo2.setAddress2((String)request.getParameter("address2"));
    	System.out.println(cvo2.getName());
    	try {
			request.setCharacterEncoding("UTF-8");
    	if (cvo == null) {
    		response.sendRedirect(request.getContextPath() + "/mainPageAlertServlet.jsp?status=8");
    		return;
    	}
    	boolean flag = cDAO.updateDB(cvo2);
    	if (flag) {
    	status="1";
    	} else {
    	status="2";
    	}
    	response.sendRedirect(request.getContextPath() + "/myPageAlertServlet.do?status="+status);
    	} catch (IOException e) {
    		// TODO Auto-generated catch block
    		e.printStackTrace();
    	};
    }
    
	protected void doGet(HttpServletRequest request, HttpServletResponse response){
		processRequest(request, response);
	}



	protected void doPost(HttpServletRequest request, HttpServletResponse response){
		processRequest(request, response);
	}

}
