package co.kh.dev.home.controller.user;
import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import co.kh.dev.common.MyUtility;
import co.kh.dev.home.model.CustomerDAO;
import co.kh.dev.home.model.CustomerVO;

@WebServlet({ "/loginPopupPageAlertServlet.do" })
public class CustomerUpdateServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;
    public CustomerUpdateServlet() {
        super();
    }
    private void processRequest(HttpServletRequest request, HttpServletResponse response) {
    	request.setCharacterEncoding("UTF-8");;
    	HttpSession session = request.getSession();
    	CustomerVO cvo = MyUtility.returnCvoBySession(session);
    	String status=null;
    	if (cvo == null) {
    		response.sendRedirect(request.getContextPath() + "/mainPageAlertServlet.jsp");
    		return;
    	}
    	CustomerDAO cDAO = CustomerDAO.getInstance();
    	%>
    	<jsp:useBean id="cvo1" class="co.kh.dev.home.model.CustomerVO" />
    	<jsp:setProperty name="cvo1" property="*" />
    	<%

    	boolean flag = cDAO.updateDB(cvo1);
    	if (flag) {
    	status="1";
    	} else {
    	status="2";
    	}
    	response.sendRedirect(request.getContextPath() + "/myPageAlertServlet.do?status="+status);
    }
    
	protected void doGet(HttpServletRequest request, HttpServletResponse response){
		processRequest(request, response);
	}



	protected void doPost(HttpServletRequest request, HttpServletResponse response){
		processRequest(request, response);
	}

}
